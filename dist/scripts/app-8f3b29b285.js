function WeatherController(e,t,n,i,r,s){function a(e,t,n){var i=(e-t)/(n-t)*100;return i+"%"}function o(){t.debug("WeatherController loaded."),i.getTodayWeather(s.screenConfig.household.address).then(function(e){l.weatherDescription=e.data.weather[0].main,l.weather=e.data.main,l.thermometerStyle={height:a(l.temperature,-10,35)}}),i.getWeatherForecast(s.screenConfig.household.address).then(function(e){console.log(e),l.weatherForecast=e.data}),r(function(){l.time="day"===l.time?"night":"day"},5e3)}var l=this;l.thermometerStyle={height:"0%"},l.time=(new Date).getHours()>20||(new Date).getHours()<8?"night":"day",o()}function OpenWeatherService(e,t){var n=this,i="5e82f8d95dafe191dfa259b75be0520c";n.getTodayWeather=function(e){return t({method:"GET",url:"http://api.openweathermap.org/data/2.5/weather",params:{q:e,apikey:i,units:"metric"}})},n.getWeatherForecast=function(e){return t({method:"GET",url:"http://api.openweathermap.org/data/2.5/forecast",params:{q:e,apikey:i,units:"metric"}})}}function TransportController(e,t,n,i,r,s){function a(){t.debug("TransportController loaded!"),e.getNextBusses(r.screenConfig.busstop).then(function(e){e.data&&e.data.lijnen?c.nextBusses=e.data.lijnen:c.error="No busstop set in Planni Housekeeping"},function(e){i.nextSlide()}),i.$on("$stateChangeStart",d.destroy)}var o,l,h,d,u,p,c=this;d=Sketch.create({container:document.getElementById("city-bg"),fullscreen:!1,width:800,height:400}),d.speed=120,d.viewHeight=d.height,u=[],h=1,p=["#e2e9f1","#bdceea","#96b3d3","#839fc4","#3e617f"],c.nextBusses=[],c.formatDepartureTime=function(e){return e?e.search("'")?e.replace("'",""):e:null},a(),o=function(e){return this.reset(e)},o.prototype.reset=function(e){return this.layer=e.layer,this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this.color=e.color,this.slantedTop=0===floor(random(0,10)),this.slantedTopHeight=this.width/random(2,4),this.slantedTopDirection=0===round(random(0,1)),this.spireTop=0===floor(random(0,15)),this.spireTopWidth=random(.01*this.width,.07*this.width),this.spireTopHeight=random(10,20),this.antennaTop=!this.spireTop&&0===floor(random(0,10)),this.antennaTopWidth=this.layer/2,this.antennaTopHeight=random(5,20)},o.prototype.render=function(){if(d.fillStyle=d.strokeStyle=this.color,d.lineWidth=2,d.beginPath(),d.rect(this.x,this.y,this.width,this.height),d.fill(),d.stroke(),this.slantedTop&&(d.beginPath(),d.moveTo(this.x,this.y),d.lineTo(this.x+this.width,this.y),this.slantedTopDirection?d.lineTo(this.x+this.width,this.y-this.slantedTopHeight):d.lineTo(this.x,this.y-this.slantedTopHeight),d.closePath(),d.fill(),d.stroke()),this.spireTop&&(d.beginPath(),d.moveTo(this.x+this.width/2,this.y-this.spireTopHeight),d.lineTo(this.x+this.width/2+this.spireTopWidth,this.y),d.lineTo(this.x+this.width/2-this.spireTopWidth,this.y),d.closePath(),d.fill(),d.stroke()),this.antennaTop)return d.beginPath(),d.moveTo(this.x+this.width/2,this.y-this.antennaTopHeight),d.lineTo(this.x+this.width/2,this.y),d.lineWidth=this.antennaTopWidth,d.stroke()},l=function(e){return this.x=0,this.buildings=[],this.layer=e.layer,this.width={min:e.width.min,max:e.width.max},this.height={min:e.height.min,max:e.height.max},this.speed=e.speed,this.color=e.color,this.populate(),this},l.prototype.populate=function(){var e,t,n,i;for(i=0,n=[];i<=d.width+2*this.width.max;)t=round(random(this.width.min,this.width.max)),e=round(random(this.height.min,this.height.max)),this.buildings.push(new o({layer:this.layer,x:0===this.buildings.length?0:this.buildings[this.buildings.length-1].x+this.buildings[this.buildings.length-1].width,y:d.height-e,width:t,height:e,color:this.color})),n.push(i+=t);return n},l.prototype.update=function(){var e,t,n,i;if(this.x-=d.speed*this.speed*h,e=this.buildings[0],e.width+e.x+this.x<0)return i=round(random(this.width.min,this.width.max)),n=round(random(this.height.min,this.height.max)),t=this.buildings[this.buildings.length-1],e.reset({layer:this.layer,x:t.x+t.width,y:d.height-n,width:i,height:n,color:this.color}),this.buildings.push(this.buildings.shift())},l.prototype.render=function(){var e;for(e=this.buildings.length,d.save(),d.translate(this.x,(d.height-d.viewHeight)/20*this.layer);e--;)this.buildings[e].render(e);return d.restore()},d.setup=function(){var e,t;for(e=5,t=[];e--;)t.push(u.push(new l({layer:e+1,width:{min:15*(e+1),max:25*(e+1)},height:{min:180-35*e,max:350-40*e},speed:.003*(e+1),color:p[e]})));return t},d.clear=function(){return d.clearRect(0,0,d.width,d.height)},d.update=function(){var e,t;for(h=d.dt<.1?.1:d.dt/16,h=h>5?5:h,e=u.length,t=[];e--;)t.push(u[e].update(e));return t},d.draw=function(){var e,t;for(e=u.length,t=[];e--;)t.push(u[e].render(e));return t}}function DelijnService(e){this.getNextBusses=function(t){return e({method:"GET",url:"https://www.delijn.be/rise-api-core/haltes/doorkomstenditmoment/"+t+"/13"})}}function SetupController(e,t,n,i,r){function s(){e.debug("SetupController loaded."),l=i(a,5e3)}function a(){n.getScreenConfig(function(e,t){t&&(i.cancel(l),o.screenName=t.name,h=i(function(){o.countdown<=0&&(i.cancel(h),r.go("app")),o.countdown--},1e3))})}var o=this;o.uiUrl=t.uiUrl,o.screenCode=n.screenCode,o.screenName=null,o.countdown=15;var l,h;s()}function ApiService(e,t,n,i){var r=this;const s={headers:{PlanniScreenCode:n.screenCode}};r.getMessages=function(t){return e.get(i.apiUrl+"messages",s)},r.getScreenConfig=function(){return e.get(i.apiUrl+"screen",s)}}function MessagesController(e,t){function n(){e.log("MessagesController loaded!"),t.getMessages().then(function(t){e.debug(t),i.messages=t.data},function(t){e.error("Getting messages failed:",t)})}var i=this;i.messages=[],n()}function routesConfig(e,t,n){t.otherwise("/weather"),e.state("setup",{url:"/setup",templateUrl:"app/setup/setup.html",controller:"SetupController as setup"}).state("app",{url:"/",template:"<ui-view/>",redirectTo:"app.weather",controller:"MainController as main"}).state("app.weather",{url:"weather",templateUrl:"app/weather/weather.html",controller:"WeatherController as weather"}).state("app.transport",{url:"transport",templateUrl:"app/transport/transport.html",controller:"TransportController as transport"}).state("app.messages",{url:"messages",templateUrl:"app/messages/messages.html",controller:"MessagesController as messages"})}function MainController(e,t,n,i){function r(){n.debug("MainController loaded!")}currentSlideId=0,slides=[{name:"weather",duration:5e3},{name:"transport",duration:5e3},{name:"messages",duration:5e3}];r()}WeatherController.$inject=["$document","$log","$timeout","OpenWeatherService","$interval","ScreenConfigService"],OpenWeatherService.$inject=["$log","$http"],SetupController.$inject=["$log","AppConfig","ScreenConfigService","$interval","$state"],routesConfig.$inject=["$stateProvider","$urlRouterProvider","$locationProvider"],MainController.$inject=["$timeout","$state","$log","$rootScope"],TransportController.$inject=["DelijnService","$log","$window","$rootScope","ScreenConfigService","$scope"],DelijnService.$inject=["$http"],ApiService.$inject=["$http","$log","ScreenConfigService","AppConfig"],MessagesController.$inject=["$log","ApiService"],angular.module("app",["ui.router"]).run(["ScreenConfigService","ApiService","$rootScope","$state","$transitions",function(e,t,n,i,r){r.onStart({to:"setup"},function(t){e.getScreenConfig(function(e,t){return!t})}),r.onStart({},function(e){var t=e.to();e.addResolvable({token:"screenConfig",deps:["$state","ScreenConfigService","$q"],resolveFn:function(e,n,i){return new i(function(i,r){n.getScreenConfig(function(n,s){n&&!t.name.includes("setup")?(e.go("setup"),r()):i(),s&&t.name.includes("setup")?(e.go("app"),r()):i()})})}})})}]),angular.module("app").controller("WeatherController",WeatherController),angular.module("app").service("OpenWeatherService",OpenWeatherService),angular.module("app").controller("TransportController",TransportController),angular.module("app").service("DelijnService",DelijnService),angular.module("app").controller("SetupController",SetupController),angular.module("app").service("ApiService",ApiService),angular.module("app").controller("MessagesController",MessagesController),/* Copyright (C) 2013 Justin Windle, http://soulwire.co.uk */
!function(e,t){"object"==typeof exports?module.exports=t(e,e.document):"function"==typeof define&&define.amd?define(function(){return t(e,e.document)}):e.Sketch=t(e,e.document)}("undefined"!=typeof window?window:this,function(e,t){"use strict";function n(e){return"[object Array]"==Object.prototype.toString.call(e)}function i(e){return"function"==typeof e}function r(e){return"number"==typeof e}function s(e){return"string"==typeof e}function a(e){return S[e]||String.fromCharCode(e)}function o(e,t,n){for(var i in t)!n&&i in e||(e[i]=t[i]);return e}function l(e,t){return function(){e.apply(t,arguments)}}function h(e){var t={};for(var n in e)"webkitMovementX"!==n&&"webkitMovementY"!==n&&(i(e[n])?t[n]=l(e[n],e):t[n]=e[n]);return t}function d(e){function t(t){i(t)&&t.apply(e,[].splice.call(arguments,1))}function n(e){for(E=0;E<ee.length;E++)I=ee[E],s(I)?j[(e?"add":"remove")+"EventListener"].call(j,I,W,!1):i(I)?W=I:j=I}function r(){M(P),P=D(r),Q||(t(e.setup),Q=i(e.setup)),Y||(t(e.resize),Y=i(e.resize)),e.running&&!X&&(e.dt=(B=+new Date)-e.now,e.millis+=e.dt,e.now=B,t(e.update),J&&(e.retina&&(e.save(),e.autoclear&&e.scale(V,V)),e.autoclear&&e.clear()),t(e.draw),J&&e.retina&&e.restore()),X=++X%e.interval}function l(){j=K?e.style:e.canvas,H=K?"px":"",F=e.width,q=e.height,e.fullscreen&&(q=e.height=C.innerHeight,F=e.width=C.innerWidth),e.retina&&J&&V&&(j.style.height=q+"px",j.style.width=F+"px",F*=V,q*=V),j.height!==q&&(j.height=q+H),j.width!==F&&(j.width=F+H),J&&!e.autoclear&&e.retina&&e.scale(V,V),Q&&t(e.resize)}function d(e,t){return N=t.getBoundingClientRect(),e.x=e.pageX-N.left-(C.scrollX||C.pageXOffset),e.y=e.pageY-N.top-(C.scrollY||C.pageYOffset),e}function u(t,n){return d(t,e.element),n=n||{},n.ox=n.x||t.x,n.oy=n.y||t.y,n.x=t.x,n.y=t.y,n.dx=n.x-n.ox,n.dy=n.y-n.oy,n}function p(e){if(e.preventDefault(),O=h(e),O.originalEvent=e,O.touches)for(z.length=O.touches.length,E=0;E<O.touches.length;E++)z[E]=u(O.touches[E],z[E]);else z.length=0,z[0]=u(O,Z);return o(Z,z[0],!0),O}function c(n){for(n=p(n),G=(_=ee.indexOf(U=n.type))-1,e.dragging=!!/down|start/.test(U)||!/up|end/.test(U)&&e.dragging;G;)s(ee[G])?t(e[ee[G--]],n):s(ee[_])?t(e[ee[_++]],n):G=0}function g(n){L=n.keyCode,R="keyup"==n.type,te[L]=te[a(L)]=!R,t(e[n.type],n)}function m(n){e.autopause&&("blur"==n.type?x:v)(),t(e[n.type],n)}function v(){e.now=+new Date,e.running=!0}function x(){e.running=!1}function T(){(e.running?x:v)()}function $(){J&&e.clearRect(0,0,e.width*V,e.height*V)}function k(){A=e.element.parentNode,E=b.indexOf(e),A&&A.removeChild(e.element),~E&&b.splice(E,1),n(!1),x()}var P,W,j,A,N,E,H,B,I,O,U,L,R,G,_,F,q,X=0,z=[],Y=!1,Q=!1,V=C.devicePixelRatio||1,K=e.type==w,J=e.type==f,Z={x:0,y:0,ox:0,oy:0,dx:0,dy:0},ee=[e.eventTarget||e.element,c,"mousedown","touchstart",c,"mousemove","touchmove",c,"mouseup","touchend",c,"click",c,"mouseout",c,"mouseover",y,g,"keydown","keyup",C,m,"focus","blur",l,"resize"],te={};for(L in S)te[S[L]]=!1;return o(e,{touches:z,mouse:Z,keys:te,dragging:!1,running:!1,millis:0,now:NaN,dt:NaN,destroy:k,toggle:T,clear:$,start:v,stop:x}),b.push(e),e.autostart&&v(),n(!0),l(),r(),e}for(var u,p,c="E LN10 LN2 LOG2E LOG10E PI SQRT1_2 SQRT2 abs acos asin atan ceil cos exp floor log round sin sqrt tan atan2 pow max min".split(" "),g="__hasSketch",m=Math,f="canvas",v="webgl",w="dom",y=t,C=e,b=[],x={fullscreen:!0,autostart:!0,autoclear:!0,autopause:!0,container:y.body,interval:1,globals:!0,retina:!1,type:f},S={8:"BACKSPACE",9:"TAB",13:"ENTER",16:"SHIFT",27:"ESCAPE",32:"SPACE",37:"LEFT",38:"UP",39:"RIGHT",40:"DOWN"},T={CANVAS:f,WEB_GL:v,WEBGL:v,DOM:w,instances:b,install:function(e){if(!e[g]){for(var t=0;t<c.length;t++)e[c[t]]=m[c[t]];o(e,{TWO_PI:2*m.PI,HALF_PI:m.PI/2,QUARTER_PI:m.PI/4,random:function(e,t){return n(e)?e[~~(m.random()*e.length)]:(r(t)||(t=e||1,e=0),e+m.random()*(t-e))},lerp:function(e,t,n){return e+n*(t-e)},map:function(e,t,n,i,r){return(e-t)/(n-t)*(r-i)+i}}),e[g]=!0}},create:function(e){return e=o(e||{},x),e.globals&&T.install(self),u=e.element=e.element||y.createElement(e.type===w?"div":"canvas"),p=e.context=e.context||function(){switch(e.type){case f:return u.getContext("2d",e);case v:return u.getContext("webgl",e)||u.getContext("experimental-webgl",e);case w:return u.canvas=u}}(),(e.container||y.body).appendChild(u),T.augment(p,e)},augment:function(e,t){return t=o(t||{},x),t.element=e.canvas||e,t.element.className+=" sketch",o(e,t,!0),d(e)}},$=["ms","moz","webkit","o"],k=self,P=0,W="AnimationFrame",j="request"+W,A="cancel"+W,D=k[j],M=k[A],N=0;N<$.length&&!D;N++)D=k[$[N]+"Request"+W],M=k[$[N]+"Cancel"+W];return k[j]=D=D||function(e){var t=+new Date,n=m.max(0,16-(t-P)),i=setTimeout(function(){e(t+n)},n);return P=t+n,i},k[A]=M=M||function(e){clearTimeout(e)},T}),angular.module("app").service("ScreenConfigService",["$http","AppConfig",function(e,t){var n=this;n.screenCode="123ABC",n.screenConfig=null;const i={headers:{PlanniScreenCode:n.screenCode}};n.getScreenConfig=function(r){return n.screenConfig?r(null,n.screenConfig):void e.get(t.apiUrl+"screen",i).then(function(e){n.screenConfig=e.data,console.log(n.screenConfig),r(null,n.screenConfig)},function(e){r(e)})}}]),angular.module("app").config(routesConfig),angular.module("app").controller("MainController",MainController),angular.module("app").constant("AppConfig",{apiUrl:"http://planni.app/api/",uiUrl:"http://planni.app/"}),angular.module("app").run(["$templateCache",function(e){e.put("app/layout/layout.html","<ui-view></ui-view>"),e.put("app/messages/messages.html",'<div class="slide slide-messages">\r\n  <div class="messages">\r\n    <aside class="note-wrap note-yellow">\r\n      <p>Don\'t forget to pick-up milk if you\'re home early!</p>\r\n      <span>Love, mum</span>\r\n    </aside>\r\n\r\n    <aside class="note-wrap note-pink note-big">\r\n      <p>Hi family, <br>I\'m at Marcus\' for the afternoon and will be back around 8PM. Let\'s have dinner with the family then. I\'m making garlic bread! Let me know when you\'re home.</p>\r\n      <span>XO Dad</span>\r\n    </aside>\r\n\r\n    <aside class="note-wrap note-blue">\r\n      <p>Don\'t forget grandma\'s birthday tomorrow!</p>\r\n      <span>Alex</span>\r\n    </aside>\r\n  </div>\r\n</div>\r\n'),e.put("app/setup/setup.html",'<div class="slide slide-setup">\n  <div ng-hide="setup.screenName">\n    <h1>Hello, I\'m a Planni Screen!</h1>\n    <p class="lead">\n      Go to <strong>{{setup.uiUrl}}</strong>to configure me<br>\n      and use the following code:<br>\n      <span class="code">{{setup.screenCode}}</span>\n    </p>\n  </div>\n\n  <div ng-show="setup.screenName">\n    <h1>{{setup.screenName}}</h1>\n    <p class="lead">We\'re done here! Have fun using your Planni!</p>\n    <p class="lead">Get ready... {{setup.countdown}}</p>\n  </div>\n\n  <img src="images/planni_char_white.svg" class="planni-char" alt="Planni">\n</div>\n'),e.put("app/transport/transport.html",'<div class="slide slide-transport">\n\n  <div class="content" ng-show="transport.nextBusses[0]">\n    <h2>Volgende bus in</h2>\n    <h1>{{transport.formatDepartureTime(transport.nextBusses[0].vertrekTijd)}} minuten</h1>\n  </div>\n\n  <div class="content" ng-show="transport.error">\n    <h2>Error:</h2>\n    <h3>{{transport.error}}</h3>\n  </div>\n\n  <div class="schedule-ticker">\n    <h2 class="text-center" ng-hide="transport.nextBusses.length">Laden...</h2>\n    <table class="table table-condensed">\n      <tr ng-repeat="bus in transport.nextBusses">\n        <td class="lijnNummer">{{bus.lijnNummer}}</td>\n        <td>{{bus.bestemming}}</td>\n        <td class="vertrekTijd">{{bus.vertrekTijd}}</td>\n      </tr>\n    </table>\n  </div>\n\n  <img src="images/slides/transport/bus.png" alt="Bus" class="bus">\n  <div id="city-bg"></div>\n\n</div>\n'),e.put("app/weather/weather.html",'<div class="slide slide-weather" ng-class="weather.time">\n\n  <div class="content">\n    <h1>{{weather.weather.temp | number: 1}}°C, {{weather.weatherDescription}}</h1>\n    <h2>Tomorrow 2°C, snow</h2>\n  </div>\n\n  <div class="content-bottom">\n    <h2>MIN {{weather.weather.temp_min}}°C | MAX {{weather.weather.temp_max}}°C | {{weather.weather.pressure}} PSI</h2>\n  </div>\n\n  <div id="thermometer" ng-click="weather.time = (weather.time === \'day\' ? \'night\' : \'day\')">\n    <span class="glass floating">\n      <span class="amount" ng-style="weather.thermometerStyle" style="height: 0%"></span>\n    </span>\n    <div class="bulb floating">\n      <span class="red-circle"></span>\n      <span class="filler">\n          <span></span>\n      </span>\n    </div>\n    <div class="shade"></div>\n  </div>\n\n  <div class="landscape">\n    <div class="moon"></div>\n    <div class="sun"></div>\n    <div class="hills">\n      <div></div>\n      <div></div>\n      <div></div>\n      <div></div>\n      <div></div>\n    </div>\n    <div class="trees">\n      <div><span></span></div>\n      <div><span></span></div>\n      <div><span></span></div>\n      <div><span></span></div>\n      <div><span></span></div>\n      <div><span></span></div>\n      <div><span></span></div>\n      <div><span></span></div>\n      <div><span></span></div>\n      <div><span></span></div>\n      <div><span></span></div>\n      <div><span></span></div>\n      <div><span></span></div>\n      <div><span></span></div>\n      <div><span></span></div>\n      <div><span></span></div>\n      <div><span></span></div>\n      <div><span></span></div>\n    </div>\n  </div>\n\n  <canvas id="snow"></canvas>\n<!--\n  <div class="family">\n\n  </div>-->\n</div>\n')}]);
//# sourceMappingURL=../maps/scripts/app-8f3b29b285.js.map
